---
description: 扫描当前session，提取认知/思维/偏好信号，写入extract-buffer.md。在目标session的上下文中运行——当前session或通过 --resume 恢复的历史session均可。
---

# /extract

扫描当前session的完整对话，提取值得长期记录的信号，追加写入 `D:\Life_with_AI\profile\ai-infra\extract-buffer.md`。

---

## 文件引用

| 标签 | 文件 | 角色 | 访问方式 |
|------|------|------|----------|
| A | `extract-buffer.md` | 临时缓冲：写入提取的信号 | 追加写入 |
| B | `Alex-coder.md` | 代码领域的当前认知状态 | 仅读取 |
| C | `Alex-coder-log.md` | 仅追加的审计日志，供人工审视 | （不访问） |
| D | `Alex-core.md` | 人格级特征、思维模式、核心偏好 | （不访问） |

---

## 约束

- **读取**当前session的对话内容
- **读取**对应领域的B文件（如 `Alex-coder.md`）用于认知状态对比
- **不加载** C（日志）和 D（核心）文件
- **只写** extract-buffer.md（追加，不覆盖已有内容）
- **不判断**去重、不做目标文件的路由决策——这些是 `/sync` 的职责
- 如果当前session没有任何值得提取的信号，直接告知用户"本次session无可提取信号"，不写入任何内容

---

## 信号类型定义

### [cognition] 认知信号

记录Alex在某个具体知识点上的认知状态变化或认知状态暴露。**对照B文件**判断观察到的行为是否构成状态变化。

**提取条件**（满足任一即可）：
- Alex提出了一个问题，暴露了对某概念/工具/流程的不理解 → `认知缺陷`
- Alex听了AI的解释后表达了初步理解（"原来如此"、"我明白了"、"好的"） → `部分理解`（认知暴露，不是掌握）
- Alex表示自己已经知道AI正在解释的内容（"这个我知道"、"不用解释"、"跳过"） → `已掌握`
- Alex展现了**行为性掌握**：在实际操作语境中正确使用了某个概念/工具/流程（如B中记录"提交PR"为认知缺陷或部分理解，Alex在session中下达了"帮我把这个提交PR"的指令） → `已掌握`
- Alex对B中标记为 `部分理解` 或 `已掌握` 的知识点提出了基础性问题 → `认知缺陷`（认知回退）

**不提取**：
- Alex问了一个纯操作性问题（"这个命令怎么拼"），没有认知层面的意义
- AI主动讲解了某个概念，但Alex没有任何反应或互动——无法判断Alex是否吸收
- Alex日常使用了**B中未追踪**的概念——没有基线可对比
- Alex使用了B中已标记为 `已掌握` 的概念且没有变化——不是信号，只是正常使用

**记录格式**：
```
[cognition] {知识点的简短描述}
  状态：{认知缺陷 | 部分理解 | 已掌握}
  依据：{session中的具体表现，1-2句话}
  参照：{如果状态判断依赖B的对比，注明B的当前记录，如"B：部分理解"或"B：未追踪"}
```

### [thinking] 思维信号

记录Alex的思维模式、决策逻辑、问题解决方式中出现的模式或变化。

**提取条件**（满足任一即可）：
- Alex在做决策时展现了一个清晰的优先级排序（比如选择了成本更低但功能更少的方案）
- Alex的论证方式体现了某种可复现的思维模式（比如总是先问"最坏情况是什么"）
- Alex在当前session中展现出思维模式的转变（如先用一种方式思考，后来改用另一种方式）
- Alex明确表达了一个关于"怎么想问题"的元认知（比如"我觉得应该先验证再扩展"）

**不提取**：
- 单纯的情绪表达（"这太烦了"）——除非它揭示了一个价值判断
- 日常的任务推进，没有决策点
- AI引导的思路，Alex只是被动跟随

**记录格式**：
```
[thinking] {思维模式或决策逻辑的简短描述}
  依据：{session中的具体表现，1-2句话}
```

### [preference] 偏好信号

记录Alex对AI沟通方式、工作流程、工具使用的明确偏好表达。

**提取条件**（满足任一即可）：
- Alex明确要求AI改变沟通方式（"别用比喻"、"直接说结论"、"用中文"）
- Alex对AI的某个行为表达了满意或不满（"这样解释很好"、"别再自动美化了"）
- Alex展示了一个工作习惯或流程偏好（"我习惯先跑通再优化"）

**不提取**：
- 针对当前任务的一次性指令（"这个文件放到那个目录"）——不具有跨session复用性
- 对AI能力的一般性评价（"你很有用"）——没有可操作的信号

**记录格式**：
```
[preference] {偏好的简短描述}
  依据：{session中的具体表现，1-2句话}
```

---

## 输出规范

### 写入格式

在 extract-buffer.md 末尾追加以下格式的块：

```markdown
---
## Extract {YYYY-MM-DD HH:MM}
主题：{session的主要话题，一句话概括}
来源：{当前工作区目录名}

{所有提取的信号，每条之间空一行}
```

> **工作区检测**：使用当前工作目录名（Claude Code启动时的目录）作为来源值。

### 示例输出

```markdown
---
## Extract 2026-02-16 14:30
主题：讨论git工作流和AI基础设施设计
来源：Life_with_AI

[cognition] git rebase 和 git merge 的区别
  状态：部分理解
  依据：Alex能说出两者都用于合并，但对rebase的风险场景理解不清
  参照：B：未追踪

[cognition] 提交PR流程
  状态：已掌握
  依据：Alex指示"帮我把这个提交PR到main分支"——在实际操作中正确使用了该概念
  参照：B：部分理解

[cognition] 环境变量分离
  状态：认知缺陷
  依据：Alex问"为什么要把环境变量分开？"——基础概念性问题
  参照：B：已掌握（认知回退）

[thinking] 先验证核心逻辑再考虑扩展
  依据：在讨论是否先做跨平台适配时，Alex坚持"核心没跑通不做扩展"

[preference] 解释技术概念时用术语但附带一句上下文
  依据：Alex说"直接用术语，但第一次出现时告诉我它是干嘛的"
```

---

## 执行步骤

1. 读取对应领域的B文件，建立用户当前的认知基线
2. 回顾当前session的完整对话
3. 按上述三类信号定义逐一筛选，严格遵守提取条件和不提取条件
4. 如果有信号，按输出规范追加写入 extract-buffer.md
5. 向用户报告提取结果，格式见下方报告模板
6. 如果无信号，告知用户并不写入任何内容

---

## 报告模板

提取完成后，向用户报告：

```
提取完成（{日期}）：
- 主题：{session主题}
- 来源：{工作区}
- 信号：{n}条认知，{m}条思维，{k}条偏好
- 已写入 extract-buffer.md
```
